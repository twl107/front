<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>t04_셀속성1.html</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    'use strict';

    let cnt = 0;

    let today = new Date();
    let year = today.getFullYear();
    let month = today.getMonth() + 1;
    let date = today.getDate();
    let ymd = `${year}-${month}-${date}`;

    let startDate = null;
    let endDate = null;

    $(function() {
      let today = `오늘날짜 : <font color=red>${ymd}</font>`;
      console.log(today);
      $('#today').html(today);
      
      $('td').on('click', function() {
        let clickDate = parseInt($(this).text());

        // 숫자가 아닌 셀 무시
        if (isNaN(clickDate)) return;

        if (clickDate < date) {
          alert("오늘 이전일은 선택하실 수 없습니다.");
          return;
        }

        // 시작일이 없거나 모두 선택된 상태면 새로 시작
        if (!startDate || (startDate && endDate)) {
          startDate = clickDate;
          endDate = null;
        }
        else{
          if (clickDate < startDate) {
            alert("도착일은 출발일보다 이전일 수 없습니다.");
            return;
          }
          endDate = clickDate;
        }
        updateSelection();
      });

      function updateSelection() {
        $('td').removeClass('bgColor');

        if (!startDate) return;

        let start = startDate;
        let end = endDate;

        if (!end) {
          end = start;
        }

        // 배경색 적용 및 개수 카운트
        let cnt = 0;
        if(start) {
          $('td').each(function() {
            const cellNum = parseInt($(this).text());
            if (!isNaN(cellNum) && cellNum >= start && cellNum <= end) {
              $(this).addClass('bgColor');
              cnt++;
            }
          });
        }

        // 결과 출력
        let str = '';
        if (cnt>0) {
          if (endDate) {
            str = `총 <font color=red><b>${cnt-1}</b></font>박 <font color=red><b>${cnt}</b></font>일이 선택되었습니다.`;
          }
          else str = '도착일을 선택해주세요.';
        }
        $('#demo').html(str);
      }
    });

  </script>
  <style>
    .bgColor {
      background-color: yellow;
    }
  </style>
</head>
<body>
<p><br/></p>
<div class="container">
  <h3>셀 속성 연습</h3>
  <p><b id="today"></b></p>
  <table class="table table-bordered text-center">
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
      <td>20</td>
    </tr>
    <tr>
      <td>21</td>
      <td>22</td>
      <td>23</td>
      <td>24</td>
      <td>25</td>
    </tr>
    <tr>
      <td>26</td>
      <td>27</td>
      <td>28</td>
      <td>29</td>
      <td>30</td>
    </tr>
  </table>
  <hr/>
  <div id="demo"></div>
</div>
</body>
</html>